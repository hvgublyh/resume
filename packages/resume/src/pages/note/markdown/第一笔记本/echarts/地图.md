---
title: 地图
updated: 2019-12-25T15:22:42
created: 2019-11-03T21:19:05
---

1.html导入JS文件
\<scriptsrc="js/echarts.min.js"type="text/javascript"\>\</script\>

\<scriptsrc="js/shangdong.js"type="text/javascript"\>\</script\>

\<scriptsrc="js/layout.js"type="text/javascript"\>\</script\>

2.js写方法
/\*\*

\*生成地图

\*/

functionfnInitMap(){

//获取div

vardomMap=\$(".bottom")\[2\];

//填写title

vardomMapTitle=\$(domMap).find(".header")\[0\];

domMapTitle.innerHTML="山东地图";

//初始化echarts对象

varmapChart=echarts.init(\$(domMap).find(".footer")\[0\]);

//地图数据

varmapData=\[

{

name:'济南市',

value:'598'

},{

name:'青岛市',

value:'2223'

},{

name:'淄博市',

value:'637'

},{

name:'枣庄市',

value:'885'

},{

name:'东营市',

value:'768'

},{

name:'烟台市',

value:'1233'

},{

name:'潍坊市',

value:'1633'

},{

name:'济宁市',

value:'1768'

},{

name:'泰安市',

value:'1233'

},{

name:'山东省',

value:'3633'

}

\];

//纵坐标轴名字

varynameMap=\[\];

for(vari=0;i\<10;i++){

ynameMap.push(mapData\[i\].name);

}

//设置地图参数

varoption={

//位置设置

grid:{

right:'5%',

bottom:'3%',

width:'25%',

height:'80%'

},

//提示框

tooltip:{

trigger:'item',

formatter:function(data){

if(!isNaN(data.value)){

returndata.name+"："+data.value;

}

}

},

//横坐标轴

xAxis:{

gridIndex:0,

axisTick:{

show:false

},

axisLabel:{

show:false

},

splitLine:{

show:false

},

axisLine:{

show:false

}

},

//纵坐标轴

yAxis:{

gridIndex:0,

interval:0,

data:ynameMap,

axisTick:{

show:false

},

axisLabel:{

show:true

},

splitLine:{

show:false

},

axisLine:{

show:false,

lineStyle:{

color:"#fff"

}

}

},

series:\[

//左边地图

{

type:'map',

map:**'shangdong'**,//引入js文件中设置的地图名

aspectScale:0.75,

left:'2%',

top:10,

width:'50%',

height:'75%',

roam:false,

itemStyle:{

normal:{

areaColor:'#667aed',

borderColor:'#fff',

borderWidth:1.5,

label:{

show:true,

color:'#fff'

},

emphasis:{

label:{

show:true

}

}

}

}

},

//右边状图

{

name:'',

type:'bar',

xAxisIndex:0,

yAxisIndex:0,

barWidth:'20%',

itemStyle:{

normal:{

color:'#f5b335'

}

},

label:{

normal:{

show:true,

position:"right",

textStyle:{

color:"#fff"

}

}

},

data:mapData

}

\]

};

//获取参数

mapChart.setOption(option);

//图表随窗口大小变化

\$(window).resize(mapChart.resize)

}

3.js调用方法
\$(function(){

fnInitTendency();

fnInitStore();

fnInitTask();

fnInitOutput();

fnInitCompanyOutput();

fnInitMap();

})

实现地图下钻:
<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 82%" />
<col style="width: 3%" />
<col style="width: 3%" />
<col style="width: 3%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>13</p>
<p>14</p>
<p>15</p>
<p>16</p>
<p>17</p>
<p>18</p>
<p>19</p>
<p>20</p>
<p>21</p>
<p>22</p>
<p>23</p>
<p>24</p>
<p>25</p>
<p>26</p>
<p>27</p>
<p>28</p>
<p>29</p>
<p>30</p>
<p>31</p>
<p>32</p>
<p>33</p>
<p>34</p>
<p>35</p>
<p>36</p>
<p>37</p>
<p>38</p>
<p>39</p>
<p>40</p>
<p>41</p>
<p>42</p>
<p>43</p>
<p>44</p>
<p>45</p>
<p>46</p>
<p>47</p>
<p>48</p>
<p>49</p>
<p>50</p>
<p>51</p>
<p>52</p>
<p>53</p>
<p>54</p>
<p>55</p>
<p>56</p>
<p>57</p>
<p>58</p>
<p>59</p>
<p>60</p>
<p>61</p>
<p>62</p>
<p>63</p>
<p>64</p>
<p>65</p>
<p>66</p>
<p>67</p>
<p>68</p>
<p>69</p>
<p>70</p>
<p>71</p>
<p>72</p>
<p>73</p>
<p>74</p>
<p>75</p>
<p>76</p>
<p>77</p>
<p>78</p>
<p>79</p>
<p>80</p>
<p>81</p>
<p>82</p>
<p>83</p>
<p>84</p>
<p>85</p>
<p>86</p>
<p>87</p>
<p>88</p>
<p>89</p>
<p>90</p>
<p>91</p>
<p>92</p>
<p>93</p>
<p>94</p>
<p>95</p>
<p>96</p>
<p>97</p>
<p>98</p></td>
<td><p>/**</p>
<p>* Created by hvgu on 2019/12/9.</p>
<p>*/</p>
<p>(function (echarts) {</p>
<p>var map = echarts.init(document.getElementById('map'));</p>
<p>var reset = function () {</p>
<p>map = echarts.init(document.getElementById('map'));</p>
<p>map.setOption({</p>
<p>geo: {</p>
<p>map: 'mapCity',</p>
<p>label: {</p>
<p>emphasis: {</p>
<p>show: true,</p>
<p>color: '#fff'</p>
<p>}</p>
<p>},</p>
<p>roam: true, //允许拖动</p>
<p>itemStyle: {</p>
<p>normal: {</p>
<p>areaColor: '#00405b',</p>
<p>borderColor: '#02334a',</p>
<p>borderWidth: 1,</p>
<p>shadowColor: 'rgba(0, 189, 249, 0.5)',</p>
<p>shadowBlur: 2,</p>
<p>shadowOffsetY: 0,</p>
<p>shadowOffsetX: 0,</p>
<p>},</p>
<p>emphasis: {</p>
<p>areaColor: '#006387'</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>})</p>
<p>};</p>
<p></p>
<p></p>
<p>var level = 1;</p>
<p>var country = function () {</p>
<p>level = 1;</p>
<p>$.ajax({</p>
<p>url: 'mapdata/china.json',</p>
<p>type: 'get',</p>
<p>success: function (res) {</p>
<p>echarts.registerMap("mapCity", res);</p>
<p>map.dispose();</p>
<p>reset();</p>
<p>map.on('click', (params) =&gt; {</p>
<p>const provinceCode = res.features.filter((val) =&gt; {</p>
<p>if (val.properties.name.indexOf(params.name) !== -1) {</p>
<p>return true;</p>
<p>}</p>
<p>});</p>
<p>console.log(provinceCode[0]);</p>
<p>province(provinceCode[0].properties.adcode, params.name)</p>
<p>});</p>
<p>}</p>
<p>})</p>
<p>};</p>
<p></p>
<p>var province = function (id, name) {</p>
<p>level = 2;</p>
<p>$.ajax({</p>
<p>url: 'mapdata/geometryProvince/' + id + '.json',</p>
<p>type: 'get',</p>
<p>success: function (res) {</p>
<p>echarts.registerMap("mapCity", res);</p>
<p>map.dispose();</p>
<p>reset();</p>
<p>map.on('click', (params) =&gt; {</p>
<p>const provinceCode = JSON.parse(res).features.filter((val) =&gt; {</p>
<p>if (val.properties.name.indexOf(params.name) !== -1) {</p>
<p>return true</p>
<p>}</p>
<p>});</p>
<p>console.log(provinceCode[0].properties);</p>
<p>city(provinceCode[0].properties.adcode, params.name)</p>
<p>});</p>
<p>}</p>
<p>})</p>
<p>};</p>
<p>var city = function (id, name) {</p>
<p>level = 3;</p>
<p>$.ajax({</p>
<p>url: 'mapdata/geometryProvince/' + id + '.json',</p>
<p>type: 'get',</p>
<p>success: function (res) {</p>
<p>echarts.registerMap("mapCity", res);</p>
<p>map.dispose();</p>
<p>reset();</p>
<p>map.on('click', (params) =&gt; {</p>
<p>alert(params.name)</p>
<p>});</p>
<p>}</p>
<p>})</p>
<p>}</p>
<p>country()</p>
<p></p>
<p>})(echarts);</p>
<p></p>
<p></p>
<p>//geoJSON与svg的相互转换</p>
<ol type="1">
<li><p>Svg转换为getjson: <a href="http://2geojson.com/index.php">2GeoJSON | Free Online Converter to GeoJSON</a></p></li>
</ol>
<blockquote>
<p><a href="https://mygeodata.cloud/converter/svg-to-json">SVG to JSON Converter Online - MyGeodata Cloud</a></p>
</blockquote>
<ol type="1">
<li><p>geojson 转换为 svg : mapstarter-master</p></li>
</ol>
<blockquote>
<p>d3库</p>
</blockquote></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

