---
title: 层叠上下文
updated: 2025-03-03T10:01:15
created: 2021-07-15T20:58:39
---

1.  什么是层叠上下文
层叠上下文是一个网页元素在三维空间中的概念，是元素在z轴上的一个相对位置的描述。
1.  为什么需要层叠上下文
只有元素成为了层叠上下文元素，才可以设置元素在z轴上的位置，子节点相对于层叠上下文相对定位。
1.  同一层叠上下文中视图的层叠关系.
![](C:\Users\hvgub\AppData\Local\Temp\第一笔记本\pandoc/media/image1.png)

**注意**

如果父元素没有产生层叠上下文, 子元素设置负的z-index, 可以将子元素放置在父元素下面

如果是在同一上下文中, 先按上图比较层叠顺序, 如果是相同的层叠顺序, 则比较是否产生层叠上下文, 元素先后等.

1.  对于不同层叠上下文
DIV1 = Root.z-index \| DIV1.z-index = 0 \| 5

DIV2 = Root.z-index \| DIV2.z-index = 0 \| 2

DIV3 = Root.z-index \| DIV3.z-index = 0 \| 3

DIV4 = Root.z-index \| DIV3.z-index \| DIV4.z-index = 0 \| 3 \| 6

其中DIV4为DIV3的子元素

这种情况需要溯源,在同一层叠上下文下比较,即 DIV2 \< DIV4 \< DIV1

1.  什么时候产生层叠上下文
    - 根标签会产生一个层叠上下文
    - position 是 absolute 或者 relative 并且 z-index 不为 auto 的元素。
    - position 是 fixed 或者 sticky 的元素。
    - 所有 flex container/grid (display属性)的 z-index 不为 auto 的子元素
    - 所有 opacity 小于 1 的元素。
    - 在指定了以下 css 属性且属性值不为 none 时
      - transform
      - filter
      - mask / mask-image / mask-border
      - perspective
      - clip-path
注意
- 产生层叠上下文的元素,在没有配置z-index的情况下,要比没有产生层叠上下文的元素要优先显示
![](C:\Users\hvgub\AppData\Local\Temp\第一笔记本\pandoc/media/image2.png)

![](C:\Users\hvgub\AppData\Local\Temp\第一笔记本\pandoc/media/image3.png)

![](C:\Users\hvgub\AppData\Local\Temp\第一笔记本\pandoc/media/image4.png)

- 在没有产生层叠上下文的情况上,子元素都在上级元素的层叠上下文中,与DOM无关
在div1和div3都设置了opacity变成层叠上下文元素之后, div1位置在div3及div3父元素之间

![](C:\Users\hvgub\AppData\Local\Temp\第一笔记本\pandoc/media/image5.png)
- 元素需要设置position(非static),z-index才生效。
